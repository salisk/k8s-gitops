---
apiVersion: v1
kind: Secret
metadata:
  name: divedb-secret
  namespace: default
type: Opaque
stringData:
  # DiveDB Application Configuration
  CONNECT_URL: |-
    postgres://${DIVEDB_POSTGRES_USER}:${DIVEDB_POSTGRES_PASS}@postgres-rw.data.svc.cluster.local/divedb
  SECRET_KEY: "${DIVEDB_SECRET_KEY}"
  ADMIN_EMAIL: "${DIVEDB_ADMIN_EMAIL}"

  # SMTP Configuration (using Mailgun)
  SMTP_HOST: "${MAILGUN_SMTP_HOST}"
  SMTP_PORT: "587"
  SMTP_SECURITY: "tls"
  SMTP_USERNAME: "${MAILGUN_SMTP_USER}"
  SMTP_PASSWORD: "${MAILGUN_SMTP_PASSWORD}"
  FROM_ADDR: "dive@${SECRET_DOMAIN}"

  # OpenID Connect / Authentik Configuration
  OPENID_ISSUER_NAME: "Authentik"
  OPENID_ISSUER_URL: "https://sso.${SECRET_DOMAIN}/oauth2/openid/divedb"
  OPENID_CLIENT_ID: "${DIVEDB_OPENID_CLIENT_ID}"
  OPENID_CLIENT_SECRET: "${DIVEDB_OPENID_CLIENT_SECRET}"

  # Postgres Init Container Configuration
  INIT_POSTGRES_DBNAME: divedb
  INIT_POSTGRES_HOST: postgres-rw.data.svc.cluster.local
  INIT_POSTGRES_USER: "${DIVEDB_POSTGRES_USER}"
  INIT_POSTGRES_PASS: "${DIVEDB_POSTGRES_PASS}"
  INIT_POSTGRES_SUPER_PASS: "${POSTGRES_SUPER_PASS}"
